# LipidFDR
Python scripts of SVM model training and testing used in a publication entitled 'A generalizable method for false-discovery rate estimation in mass spectrometry-based lipidomics'

## Data format
It should be a tab-delimited text file. A 'Class' column, which indicates the class (Verified true or Decoy) of each spectrum, is required for training a SVM model. Please refer to `train/Diacylglycerophosphoglycerols [GP0401].txt` as an example of a training set. 

For testing sets, there should be two tab-delimited text files which have decoy hits and target hits. Please refer to `test/SP0301.decoy.txt` and `test/SP0301.target.txt`.

## SVM Training
To run a SVM training, 
```bash
python scripts/svm_training.py -i train/Diacylglycerophosphoglycerols\ \[GP0401\].txt -o model/GP0401/
```
| Parameter       |  Description|
| ------------- |:-------------:|
| `-i` | input file (training set) |
| `-o` | output (model directory) |

By default, this script uses 4 metrics: 'RT', 'Score', 'Cosine Score', and 'Cosine M-1 Score'. If you want to use different metrics, you can modify the following lines of the script:
```python
# at line 58 in svm_training.py, you can use the column names you want. 
cols = ['RT', 'Score', 'Cosine Score', 'Cosine M-1 Score', 'Class']
```
### Outputs
After run, you can see these output files in `-o`.
* _histo.png
* _norm.txt
* _param.png
* _param.txt
* _scatter.png
* _svmmodel.pkl

## SVM Testing
When you have a model generated by `svm_training.py`, you can use the model as follows:
```bash
python scripts/svm_classify.py -d test/SP0301.decoy.txt -t test/SP0301.target.txt -m model/SP0301/ -o model/
```
| Parameter       |  Description|
| ------------- |:-------------:|
| `-d` | decoy file  |
| `-t` | target file |
| `-m` | a directory containing model files |
| `-o` | a directory of output files for model-use |

You MUST have the columns of the same metrics which you use in modeling. 
```python
# at line 52 in svm_classify.py, you can use the column names you want. 
cols = ['RT', 'Score', 'Cosine Score', 'Cosine M-1 Score']
```
### Outputs
After run, you can see these output files in `-o`.
* _decoy_output.txt
* _model_use.png
* _target_output.txt
* fdr.txt
